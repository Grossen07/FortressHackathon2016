       

using System.IO;
using System.Text;


 public void SaveBatteryInfo(McuBatteryDataDto entity)
        {
            var sb = new StringBuilder();
            sb.AppendLine(@"UnitId, MicroControllerId, PackageType, TempProcessId, Date, BatteryTypeId, ProcessType, StatusId, ErrorId, Voltage, Current");
            sb.AppendLine(entity.ToString());
            var fileFullName = string.Format(@"{0}\{1}.{2}.{3}.csv", Path, McuPackageType.BatteryInfo, entity.McuId, DateTime.Now.ToString(AppConst.DateTimeFormat));
            try
            {
                File.WriteAllText(fileFullName, sb.ToString());
            }
            catch(Exception exception)
            {
                throw new OperationFailureWriteCsv(fileFullName, entity.ToString(), exception);
            }
        }